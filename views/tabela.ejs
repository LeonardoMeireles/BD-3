<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="/css/reset.css">
        <link rel="stylesheet" href="/css/table.css">
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <title>Air Trava - Tabela</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>
    <script>
        function dumpTable() {
            if (option === "inference") {
                location.replace(`${window.location.origin}/dump/inference`);
            } else {
                location.replace(`${window.location.origin}/dump/audio`);
            }
        }

        function choose() {
            chooseTable()
            chooseFilter()
        }

        function chooseTable() {
            const audioTab = document.getElementById("audio-tab");
            const inferenceTab = document.getElementById("inference-tab");

            if (option === "inference" && !inferenceTab.className.includes("active")) {
                inferenceTab.className += " active";
                audioTab.className = audioTab.className.replace(" active", "");
                document.getElementById("inference_table").style.display = "";
                document.getElementById("audio_table").style.display = "none";
            } else if (option === "audio" && !audioTab.className.includes("active")) {
                audioTab.className += " active";
                inferenceTab.className = inferenceTab.className.replace(" active", "");
                document.getElementById("inference_table").style.display = "none";
                document.getElementById("audio_table").style.display = "";
            }
        }

        function chooseFilter() {
            if (option === "inference") {
                document.getElementById("inference_table_filter").style.display = "";
                document.getElementById("audio_table_filter").style.display = "none";
            } else {
                document.getElementById("inference_table_filter").style.display = "none";
                document.getElementById("audio_table_filter").style.display = "";
            }
        }

        function filterDataByParameter() {
            let td;
            
            const table = document.getElementById(`${option}_table`);

            const filter_element = document.getElementById(`${option}_table_filter`);
            const input = filter_element.getElementsByTagName("input")[0];
            const select = filter_element.getElementsByTagName("select")[0];
            const tr = table.getElementsByTagName("tr");
            const field = select.options[select.selectedIndex].value;

            const filter = input.value.toUpperCase();

            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[field];
                if (td) {
                  txtValue = td.textContent || td.innerText;
                  if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                  } else {
                    tr[i].style.display = "none";
                  }
                }       
            }
        }

        function filterByHash(clicked_hash) {
            index = document.getElementById("inference_table").getElementsByTagName("thead")[0].getElementsByTagName("th").length-1;
            document.getElementById("inference_table_filter").getElementsByTagName("select")[0].selectedIndex = index;
            document.getElementById("inference_table_filter").getElementsByTagName("input")[0].value = clicked_hash;
            filterDataByParameter();

            option='audio';
            choose();

            index = document.getElementById("audio_table").getElementsByTagName("thead")[0].getElementsByTagName("th").length-1;
            document.getElementById("audio_table_filter").getElementsByTagName("select")[0].selectedIndex = index;
            document.getElementById("audio_table_filter").getElementsByTagName("input")[0].value = clicked_hash;
            filterDataByParameter();
        }

        function editRedirect(table, id){
            location.replace(`/update/${table}/${id}`);
        }

    </script>
    <body>
        <!-- Navbar -->
        <div class="w3-top">
            <div class="w3-bar w3-blue w3-card w3-left-align w3-large">
            <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large w3-red" href="javascript:void(0);" onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
            <a href="/" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Home</a>
            <a href="/form" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Form</a>
            <a href="/tabela" class="w3-bar-item w3-button w3-padding-large w3-white">Tabela</a>
            </div>
        
            <!-- Navbar on small screens -->
            <div id="navDemo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium w3-large">
            <a href="/" class="w3-bar-item w3-button w3-padding-large">Home</a>
            </div>
        </div>
        <section class="container">
            <div class="flex-container">
                <div></div><div></div>
                <div class="spira-title">
                    <h1 id="title">Tabela Air Trava</h1>
                    <h2>Agilizando a sua viagem</h2>
                </div>
                <div>
                    <button onclick="" class="button" style="vertical-align:middle"><span>Baixar CSV </span></button>
                </div>
            </div>
        </section>
        <section class="container">
            <table id="inference_table" class="table-container">
                <thead>
                    <tr>
                        <% for( let column of tableColumns ) { %>
                            <th><h1 class="variableTitle"> <%= column %> </h1></th>
                        <% } %>
                    </tr>
                </thead>
                <tbody>
                    <% if(tableContent) { %>
                        <% for(let content of tableContent) { %>
                            <tr class="inference-row">
                                <td class="tableValue"> <%= content.test1 %></td>
                                <td class="tableValue"> <%= content.test2 %></td>
                                <td class="tableValue"> <%= content.test3 %></td>
                                <td class="tableValue"> <%= content.test4 %></td>
                                <td class="tableValue"> <%= content.test5 %></td>
                                <td><button class="tableBtn" onclick="editRedirect('test', '123')"><i class="fa fa-edit"></i></button></td>
                                <td><button class="tableBtn" onclick=""><i class="fa fa-trash"></i></button></td>
                            </tr>
                        <% } %>
                    <% } %>
                </tbody>
            </table>
        </section>
        <script>
            var option = "inference"
            document.getElementById("audio_table").style.display = "none";
            document.getElementById("audio_table_filter").style.display = "none";
            document.getElementById("inference-tab").className += " active";
            document.getElementsByClassName('table-container')[0]
                    .getElementsByTagName('thead')[0]
                    .getElementsByTagName('th')[0].style.borderRadius = '0'

        </script>
    </body>
</html>
